@page "/catalog"
@using MyShop.Models
@using MyShopBlazor.App.Data.Interface
@using MyShopBlazor.HttpApiClient

@inject ICatalog Catalog
@inject ICart Cart
@inject IJSRuntime JS
@inject IShopClient HttpClient

<h3>Список товаров</h3>

@foreach (var product in ProductList)
{
    <div>
        <p>
        @product.Name (цена: @product.Price)
        <button name="@product.Id"
                @onclick="@(() => Cart.AddingToCart(product))"
                class="btn-primary"
                type="submit">
            Купить
        </button>
        </p>
    </div>
}

@code
{
    private void SubmitToCart(Product product)
    {

        Cart.AddingToCart(product);
        JS.InvokeVoidAsync("show_message", args: "Товар добавлен в корзину!");
    }

    private IEnumerable<Product> ProductList;


    protected async override Task OnInitializedAsync()
    {
        ProductList = await HttpClient.GetProducts();
        
    }

}
