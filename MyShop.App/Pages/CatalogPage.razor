@page "/catalog"
@using MyShop.Models
@using MyShop.App.Data.Interface
@using MyShop.Client

@inject ICatalog Catalog
@inject ICart Cart
@inject IJSRuntime JS
@inject IShopClient HttpClient

<h3>Список товаров</h3>

@if (ProductList != null)
{
    @foreach (var product in ProductList)
    {
        <div>
            <p>
                @product.Name (цена: @product.Price)
                <button name="@product.Id"
                        @onclick="@(() => Cart.AddingToCart(product))"
                        class="btn-primary"
                        type="submit">
                    Купить
                </button>
            </p>
        </div>
    }
}
else
{
    <p>Load...</p>
}

@code
{
    private void SubmitToCart(Product product)
    {

        Cart.AddingToCart(product);
        JS.InvokeVoidAsync("show_message", args: "Товар добавлен в корзину!");
    }

    private IEnumerable<Product>? ProductList = null;


    protected async override Task OnInitializedAsync()
    {
        ProductList = await HttpClient.GetProducts();
        
    }

}
